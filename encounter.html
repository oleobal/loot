<head>
	<title>Encounter manager</title>
	<meta charset="utf-8"/>
	
	<script src="utility.js"></script>
	<script src="web-utility.js"></script>
	<script src="list-melee-weapons.js"></script>
	<script src="list-ranged-weapons.js"></script>
	<script src="list-armors.js"></script>
	<script src="weapons.js"></script>
	
	<script src="list-books.js"></script>
	<script src="list-books-magic.js"></script>
	<script src="books.js"></script>
	
	<script src="chest.js"></script>
	
	<script src="humanoids.js"></script>
	<script>
	
	/**
	 * keep track of used IDs rather than parse them from the DOM every time
	 * actual IDs are "part"+no, but this is just the numbers
	 * this table is to be kept in ascending order
	 * (whereas displayed participants are in initiative order)
	 */
	var participantIDs=[]
	
	
	function initialize()
	{
		document.getElementById('participants').innerHTML=""
		addParticipant("Bob")
	}
	
	/**
	 * reorder participants based on initiative
	 */
	function orderParticipants()
	{
		//TODO
	}
	
	/**
	 * change the right panel to that participant
	 */
	function displayDetailedParticipant(partID)
	{
		//TODO
	}
	
	
	function tentativelyRemoveParticipant(partID)
	{
		//TODO
	}
	
	function tentativelyAddParticipantAfter(partID)
	{
		//TODO
	}
	
	function removeParticipant(partID)
	{
		//TODO
	}
	
	function addParticipantAfter(partID)
	{
		//TODO
	} 
	
	/**
	 * add a participant to the list
	 */
	function addParticipant(name, afterid)
	{
		if (!name)
			name=""
		
		if (participantIDs.length == 0)
			partID=0
		else
			partID=participantIDs[participantIDs.length-1] + 1
		
		var p = document.createElement('div')
		p.id = "part"+partID
		p.style.borderStyle="solid"
		p.innerHTML = `
		<input  name="partName" id="partName${partID}" value="${name}" style="width:calc(100% - 4em - 1em)" required/>
		<input  name="partInit" id="partInit${partID}" value="1" style="width:2em" required/>
		<button name="partButt" id="partButt${partID}" type="button" onclick="displayDetailedParticipant(${partID})" style="width:2em;">&gt;</ button>
		<br>
		<button name="partAdd" id="partAdd${partID}" type="button" onclick="tentativelyAddParticipantAfter(${partID})" style="width:50%">Add after</ button>
		<button name="partAdd" id="partAdd${partID}" type="button" onclick="tentativelyRemoveParticipant(${partID})" style="width:50%">Remove</ button>
		`
		// TODO align the arrow button to the right
		// TODO add confirmations to add and remove buttons, somehow
		
		// TODO append after given afterid, not end 
		document.getElementById('participants').appendChild(p)
	}
	</script>
	
	<style>
	</style>
</head>
<body onload='initialize()'>


<div id="participants"
style="display:inline-block; width:30%; max-width:20em; min-height:99%; max-height:99%; overflow-y:scroll;">
<p style="font-size:150%;">This is a JavaScript app, so you'll need to enable JavaScript.<br>If you don't want to run it online, it's fine, the repository is <a href="https://github.com/oleobal/loot">here</a><p>
</div>
</body>
